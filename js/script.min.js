window.addEventListener("load",(function(){this.alert("Hello"),loadGame()}));const canvas=document.getElementById("canvas1"),ctx=canvas.getContext("2d");canvas.width=window.innerWidth,canvas.height=window.innerHeight;let moon=new Image;moon.src="assets/images/moon.jpg";let saturn=new Image;saturn.src="assets/images/saturn.png";let black_missile=new Image;black_missile.src="assets/images/black-missile.png";let deathStar=new Image;deathStar.src="assets/images/deathStar2.png";let white_missile=new Image;white_missile.src="assets/images/white-missile.png";let mushroomCloud=new Image;mushroomCloud.src="assets/images/mushroomCloud.png";let holeInGround=new Image;holeInGround.src="assets/images/holeInground.png";const MISS=1,HIT=2,OUT_OF_BOUNDS=3,NO_HIT=4;let maxStars=200,stars=[],hitPhrases=[],time=0,timerInterval=.05,gameFrame=0;const staggerFrames=155;let windVelocity=100,baseWidth=15,baseHeight=10,missileStatus=1;const ACTIVE=1,INACTIVE=0;class HitPhrases{hitPhrases=[];constructor(){this.hitPhrases.push("NICE SHOT BOB. WAY TO GO <player>."),this.hitPhrases.push("NICE FIRING <player>."),this.hitPhrases.push("WOW! THIS GUYS A HOT SHOT!"),this.hitPhrases.push("BETTER GET YOUR ACT TOGETHER <opponent>."),this.hitPhrases.push("CRACK SHOT, ACE!"),this.hitPhrases.push("NICE SHOT! GO TEAM <player>."),this.hitPhrases.push("ALRIGHT!!!!!!"),this.hitPhrases.push("DO YOU NEED GLASSES <opponent>?"),this.hitPhrases.push("TOP GUN HEY!"),this.hitPhrases.push("WISE GUY, HUH!"),this.hitPhrases.push("WHERE'D YOU LEARN TO SHOOT <opponent>?")}getPhrase(player,opponent){const rand=Math.floor(Math.random()*this.hitPhrases.length);let phrase=this.hitPhrases[rand];return""==player?phrase.replace("<player>","JOE"):phrase.replace("<player>",player),""==opponent?phrase.replace("<opponent>","JOE"):phrase.replace("<opponent>",opponent),phrase}}class ShootingStar{constructor(){this.x=Math.random()*canvas.width,this.y=0,this.speed=4*Math.random()-2}update(){this.x<0||this.y>canvas.height+100?(this.x=Math.random()*canvas.width,this.y=-10,this.speed=4*Math.random()-2):(this.x+=this.speed,this.y+=1)}draw(){ctx.fillStyle="yellow",ctx.fillRect(this.x,this.y,2,2)}}class Landscape{base1Y;base2Y;base1X;base2X;constructor(){this.createDemoLandscape()}createLandscape(){this.base1Y=getRandomInt(canvas.height-300,canvas.height-100),this.base2Y=getRandomInt(canvas.height-300,canvas.height-100),this.mountainX=canvas.width/2;const h=this.base1Y<this.base2Y?this.base1Y:this.base2Y;this.mountainY=getRandomInt(200,h),this.mountainWidth=getRandomInt(200,400),this.base1X=getRandomInt(30,this.mountainX-this.mountainWidth/2),this.base2X=getRandomInt(this.mountainX+this.mountainWidth,canvas.width-30)}createDemoLandscape(){this.base1Y=550,this.base2Y=600,this.mountainX=canvas.width/2;const h=this.base1Y<this.base2Y?this.base1Y:this.base2Y;this.mountainY=300,this.mountainWidth=250,this.base1X=100,this.base2X=canvas.width-180}draw(){let grd=ctx.createLinearGradient(0,this.mountainY,0,canvas.height);grd.addColorStop(0,"brown"),grd.addColorStop(.7,"orange"),grd.addColorStop(1,"brown"),ctx.fillStyle=grd,ctx.beginPath(),ctx.moveTo(0,this.base1Y),ctx.lineTo(this.mountainX-this.mountainWidth/2,this.base1Y),ctx.lineTo(this.mountainX,this.mountainY),ctx.lineTo(this.mountainX+this.mountainWidth/2,this.base2Y),ctx.lineTo(canvas.width,this.base2Y),ctx.lineTo(canvas.width,canvas.height),ctx.lineTo(0,canvas.height),ctx.fill(),this.drawBases()}drawBases(){ctx.fillStyle="red",ctx.beginPath(),ctx.moveTo(this.base1X-baseWidth/2,this.base1Y),ctx.lineTo(this.base1X,this.base1Y-baseHeight),ctx.lineTo(this.base1X+baseWidth/2,this.base1Y),ctx.fill(),ctx.fillStyle="yellow",ctx.beginPath(),ctx.moveTo(this.base2X-baseWidth/2,this.base2Y),ctx.lineTo(this.base2X,this.base2Y-baseHeight),ctx.lineTo(this.base2X+baseWidth/2,this.base2Y),ctx.fill()}updateScore(player1Score,player2Score){let text="Score "+player1Score+":"+player2Score;const width=ctx.measureText(text).width;ctx.fillStyle="black",ctx.font="36px Arial",ctx.fillText(text,canvas.width/2-width/2,canvas.height-40)}drawExplosion(base){const sound=document.getElementById("explosion-sound");console.info("playing sound..."),1==base?(ctx.drawImage(mushroomCloud,this.base2X-mushroomCloud.width/2,this.base2Y-78,57,78),ctx.drawImage(holeInGround,this.base2X-mushroomCloud.width/2,this.base2Y,50,20)):(ctx.drawImage(mushroomCloud,this.base1X,this.base1Y-78,57,78),ctx.drawImage(holeInGround,this.base1X-mushroomCloud.width/2,this.base1Y,50,20))}drawBaseMissiles(player1Missiles,player2Missiles){let y=canvas.height-100,x=5;for(let i=1;i<=player1Missiles;i++)ctx.drawImage(black_missile,x+25*i,y,23,72);x=canvas.width-30;for(let i=1;i<=player2Missiles;i++)ctx.drawImage(black_missile,x-25*i,y,23,72)}drawMissMarkers(player1,player2){ctx.fillStyle="white",player1.missiles.forEach(missile=>{ctx.fillRect(missile.hitX,missile.hitY-2,2,4)}),player2.missiles.forEach(missile=>{ctx.fillRect(missile.hitX,missile.hitY-2,2,4)})}}class Background{loadStars(){for(let i=0;i<maxStars;i++)stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,width:3*Math.random(),height:3*Math.random()})}draw(landscape){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle="black",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="white";for(let i=0;i<maxStars;i++)ctx.fillRect(stars[i].x,stars[i].y,stars[i].width,stars[i].height);ctx.drawImage(deathStar,canvas.width-150,15,121,107),ctx.drawImage(saturn,100,45,42,25),ctx.drawImage(moon,220,45,38,32),landscape.draw()}hitAnimation(){let r,g,b,phrases,text=(new HitPhrases).getPhrase("","");console.info(text);const interval=setInterval((function(){r=255*Math.random(),g=255*Math.random(),b=255*Math.random(),ctx.fillStyle=`rgba(${r},${g},${b}, 0.2)`,ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="white",ctx.font="40px Arial",ctx.fillText(text,canvas.width/2-ctx.measureText(text).width/2,canvas.height/2)}),300);setTimeout((function(){clearInterval(interval)}),3e3)}doGameOver(player1,player2){let text="";if(player1.score==player2.score)text="GAME OVER, DRAW!!!";else{const winner=player1.score>player2.score?player1.playerName:player2.playerName;text="GAME OVER, WELL DONE "+winner+"!!!"}const textWidth=ctx.measureText(text).width;ctx.fillStyle="white",ctx.font="40px Arial",ctx.fillText(text,canvas.width/2-textWidth/2,canvas.height/2)}}class Missile{missileX=0;missileY=0;power=0;angle=0;startX=0;startY=0;hitX=0;hitY=0;constructor(player,x,y,power,angle){time=0,missileStatus=1,this.playerTurn=player,this.startX=1==player?x+baseWidth:x-baseWidth,this.startY=y-black_missile.height/4,this.power=power,this.angle=angle,this.rotation=0}update(){let rad=this.angle*(Math.PI/180),vx=this.power*Math.cos(rad),vy=this.power*Math.sin(rad),vxWindVelocity=0,vyWindVelocity=0,x=vx*time;1==this.playerTurn?this.missileX=Math.floor(this.startX+x-0):this.missileX=Math.floor(this.startX-x-0);let y=vy*time+-4.9*Math.pow(time,2);this.missileY=Math.floor(this.startY-y-0),this.calcRotation(vx,rad)}calcRotation(vx,rad){let multiplier=0;multiplier=1==this.playerTurn?1:-1;let vy=this.power*Math.sin(rad)+-9.8*time,deg=0;vy<0?(deg=Math.atan(vx*multiplier/(-1*vy))*(180/Math.PI),this.rotation=90-deg+90):(deg=Math.atan(vx*multiplier/vy)*(180/Math.PI),this.rotation=deg)}checkForHit(landscape,base){switch(base){case 1:if(this.missileX>canvas.width)return 3;case 2:if(this.missileX<0)return 3}switch(base){case 1:return this.missileX>=landscape.base2X-baseWidth/2&&this.missileX<=landscape.base2X+baseWidth/2&&this.missileY>=landscape.base2Y-baseHeight?(console.info("HIT"),2):this.missileX>landscape.mountainX&&this.missileY>landscape.base2Y-white_missile.height/4?(console.info("MISS"),this.hitX=this.missileX+white_missile.width/4,this.hitY=landscape.base2Y,1):(console.info("MISS"),4);case 2:return this.missileX>=landscape.base1X-baseWidth/2&&this.missileX<=landscape.base1X+baseWidth/2&&this.missileY>=landscape.base1Y-baseHeight?(console.info("HIT"),2):this.missileX<landscape.mountainX&&this.missileY>landscape.base1Y-white_missile.height/4?(console.info("MISS"),this.hitX=this.missileX-white_missile.width/4,this.hitY=landscape.base1Y,1):(console.info("MISS"),4);default:return 1}}drawPath(){drawRotatedImage(white_missile,this.missileX,this.missileY,white_missile.width/4,white_missile.height/4,this.rotation)}}function drawRotatedImage(image,x,y,w,h,degrees){ctx.save(),ctx.translate(x+w/2,y+h/2),ctx.rotate(degrees*Math.PI/180),ctx.translate(-x-w/2,-y-h/2),ctx.drawImage(image,x,y,w,h),ctx.restore()}class Player{missiles=[];missileCount=5;constructor(playerName,number){this.playerNumber=number,this.playerName=playerName,this.score=0,this.missileCount=5}calculateScore(points){this.score+=points}resetScore(score){this.score=score}reduceMissiles(num){return this.missileCount-=num,this.missileCount}}class NukedEmGame{missile;playersTurn=2;player1;player2;gameOver=!1;initializeGame(){alert("initialize..."),this.shootingStar=new ShootingStar,this.landscape=new Landscape,this.landscape.createDemoLandscape(),this.background=new Background,this.background.loadStars(),this.background.draw(this.landscape),this.getPlayers()}alternateTurn(){1==this.playersTurn?this.playersTurn=2:this.playersTurn=1}getPlayers(){this.player1=new Player("Mal",1),this.player2=new Player("Waz",2)}fireMissile(power,angle){1==this.playersTurn?(this.player1.reduceMissiles(1),this.missile=new Missile(1,this.landscape.base1X,this.landscape.base1Y-10,power,angle),this.player1.missiles.push(this.missile)):(this.player2.reduceMissiles(1),this.missile=new Missile(2,this.landscape.base2X,this.landscape.base2Y-10,power,angle),this.player2.missiles.push(this.missile))}doHit(){1==this.playersTurn?this.player1.calculateScore(20):this.player2.calculateScore(20),this.landscape.drawBaseMissiles(this.player1.missiles,this.player2.missiles),this.alternateTurn()}nextMissile(){this.alternateTurn(),0!=this.player1.missileCount||0!=this.player2.missileCount?1==this.playersTurn?this.player1.missileCount>0&&this.fireMissile(getRandomInt(95,108),55):this.player2.missileCount>0&&this.fireMissile(getRandomInt(95,108),55):this.gameOver=!0}newGame(){time=0,missileStatus=1,this.fireMissile(99.9,60)}setUpScreen(){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle="black",ctx.fillRect(0,0,canvas.width,canvas.height),this.shootingStar.update(),this.shootingStar.draw(),this.background.draw(this.landscape),this.landscape.drawBaseMissiles(this.player1.missileCount,this.player2.missileCount),this.landscape.drawMissMarkers(this.player1,this.player2),this.landscape.updateScore(this.player1.score,this.player2.score),this.gameOver&&this.background.doGameOver(this.player1,this.player2)}run(){if(1==missileStatus){let result;switch(this.setUpScreen(),this.missile.checkForHit(this.landscape,this.playersTurn)){case 2:this.landscape.drawExplosion(this.playersTurn),this.background.hitAnimation(),this.doHit(),missileStatus=2,this.newGame();break;case 1:case 3:missileStatus=0,this.nextMissile();break;default:this.missile.update(),this.missile.drawPath()}}else 0==missileStatus&&this.setUpScreen();time+=timerInterval}}let nukedEm;function loadGame(){alert("loadGame"),nukedEm=new NukedEmGame,nukedEm.initializeGame(),nukedEm.newGame(),alert("animate..."),animate()}function animate(){nukedEm.run(),requestAnimationFrame(animate)}function getRandomInt(min,max){return min=Math.ceil(min),max=Math.floor(max),Math.floor(Math.random()*(max-min)+min)}function colorToHex(color){var hexadecimal=color.toString(16);return 1==hexadecimal.length?"0"+hexadecimal:hexadecimal}function convertRGBtoHex(red,green,blue){return"#"+colorToHex(red)+colorToHex(green)+colorToHex(blue)}window.addEventListener("click",(function(){nukedEm.newGame()}));
//# sourceMappingURL=script.min.js.map